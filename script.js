import{initializeApp as _0xI}from"https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";import{getAuth as _0xA,createUserWithEmailAndPassword as _0xC,signInWithEmailAndPassword as _0xS,signOut as _0xO,onAuthStateChanged as _0xAC}from"https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js";import{getFirestore as _0xF,doc as _0xD,getDoc as _0xG,setDoc as _0xSD,updateDoc as _0xU,increment as _0xIC,onSnapshot as _0xOS,collection as _0xCL,addDoc as _0xAD,serverTimestamp as _0xST,runTransaction as _0xRT,arrayUnion as _0xAU}from"https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js";
const _e=s=>atob(s);const _k={k:_e('YXBpS2V5'),d:_e('YXV0aERvbWFpbg=='),p:_e('cHJvamVjdElk'),b:_e('c3RvcmFnZUJ1Y2tldA=='),s:_e('bWVzc2FnaW5nU2VuZGVySWQ='),a:_e('YXBwSWQ='),v1:_e('QUl6YVN5QnMtTDJzZ3FTUU12aVJVMy1HT0RORDhXdDR1YWo3dTdV'),v2:_e('YmNyLXRvb2wuZmlyZWJhc2VhcHAuY29t'),v3:_e('YmNyLXRvb2w='),v4:_e('YmNyLXRvb2wuZmlyZWJhc2VzdG9yYWdlLmFwcA=='),v5:_e('OTM3Nzc5MTYxMTIy'),v6:_e('MTo5Mzc3NzkxNjExMjI6d2ViOjNiZDY2YzFhMGE2ZmVlNDIxZTgyN2I='),u:_e('dXNlcnM='),t:_e('dHJhbnNhY3Rpb25z'),h:_e('aGlzdG9yeQ=='),m:_e('TW9Mbw==')};
const _c={};[_k.k,_k.d,_k.p,_k.b,_k.s,_k.a].forEach((k,i)=>_c[k]=[_k.v1,_k.v2,_k.v3,_k.v4,_k.v5,_k.v6][i]);
const _0xApp=_0xI(_c),_0xAu=_0xA(_0xApp),_0xDb=_0xF(_0xApp);
const _0xW=_e('aHR0cHM6Ly9kaXNjb3JkLmNvbS9hcGkvd2ViaG9va3MvMTQ0ODM3NTUwNjAxNjc5NjgzMy84Sy01UWxuSm9henRxd000eTBXajROMVdyUXBaLS1PMXlsWVZnTTlzU000ZnRHaE9Wd1BtQ3ZYU0lYY1FrVThoVEc5Yg==');
const _0xM={p:_e('MDcwNTQ5OTkwMw=='),n:_e('SE9ORyBDSEkgVEhBTkg='),s:!1};let _u=null,_tk=0,_ul=null,_v='home',_d={l:[],c:Array(10).fill(0)},_st={c:0,t:0},_pr=null;
const _t={vi:{l:_e('RGFuZyB0YWkuLi4='),e:_e('TG9p'),s:_e('VGhhbmggY29uZw=='),et:_e('SGV0IFRva2VuIQ=='),wt:_e('Q2hvIGR1IGxpZXUuLi4='),an:_e('QUkgRGFuZyBQaGFuIFRpY2guLi4='),cr:_e('VGh1IHRoYXA6'),nm:_e('Q2FuIHRoZW0gZHUgbGlldQ==')},en:{l:"Loading...",e:"Error",s:"Success",et:"No Tokens!",wt:"Waiting...",an:"Analyzing...",cr:"Collecting:",nm:"Need data"}};const _l=localStorage.getItem('lg')||'vi';const _T=k=>_t[_l][k]||k;
const $=i=>document.getElementById(i);
function _L(b,s=1){const x=$(b);if(x){x.disabled=s;x.innerHTML=s?`‚è≥ ${_T('l')}`:x.dataset.o||'OK'}}
async function _P(t,n,p){if(!_u)return;const oid=`MM${Math.floor(Math.random()*90000)+1000}`;const l=`momo://app?action=transfer&to=${_0xM.p}&amount=${p}&comment=${oid}`;const o=document.createElement('div');o.style.cssText='position:fixed;inset:0;background:rgba(0,0,0,0.9);z-index:9999;display:flex;align-items:center;justify-content:center';o.innerHTML=`<div style="background:#fff;padding:20px;border-radius:10px;text-align:center;color:#000"><h3 style="font-weight:bold;margin-bottom:10px">PAYMENT</h3><div style="background:#eee;padding:10px;margin:10px 0;font-family:monospace">${oid}</div><a href="${l}" style="display:block;background:#d82d8b;color:#fff;padding:10px;border-radius:5px;text-decoration:none;margin-bottom:10px">OPEN APP</a><button id="bx" style="background:#10b981;color:#fff;border:none;padding:10px;width:100%;border-radius:5px">CONFIRM</button><button id="bc" style="margin-top:10px;background:none;border:none;color:#555">Close</button></div>`;document.body.appendChild(o);$('bc').onclick=()=>o.remove();$('bx').onclick=async()=>{_L('bx',1);if(await _O(oid,t,p,n)){o.innerHTML=`<div style="color:#fff;font-weight:bold;font-size:20px">PENDING...</div>`;setTimeout(()=>o.remove(),3000)}};}
async function _O(id,tk,pr,pk){if(!_u)return!1;try{await _0xSD(_0xD(_0xDb,_k.t,id),{uid:_u.uid,email:_u.email,orderId:id,packageName:pk,tokens:tk,price:pr,status:'pending',createdAt:_0xST()});if(_0xW.includes('discord'))fetch(_0xW,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({username:"BOT",embeds:[{title:"NEW ORDER",color:16711900,fields:[{name:"U",value:_u.email,inline:1},{name:"T",value:`+${tk}`,inline:1},{name:"ID",value:id}]}]})});return!0}catch(e){return!1}}
function _A(t){if(_pr&&t!=='T'){_st.t++;if(_pr===t)_st.c++;_Uw()}let m=0,v=_d.c[0];for(let i=1;i<10;i++)if(_d.c[i]<v){v=_d.c[i];m=i}_d.l.push({t,c:m,r:v});_d.c[m]++;_Dr();const h=_d.l.length;if(h<5){$('ai-result').innerText=`${h}/5`;$('ai-reason').innerText=`${_T('cr')} ${h}`;_pr=null}else{if(_tk>0)_R();else alert(_T('et'))}}
async function _R(){if(!_u)return;try{await _0xU(_0xD(_0xDb,_k.u,_u.uid),{tokens:_0xIC(-1)})}catch(e){}$('ai-result').innerText=_T('an');setTimeout(()=>{const p=_Z();_pr=p.r;$('ai-result').style.color=p.r==='B'?'#ef4444':'#3b82f6';$('ai-result').innerText=p.r;$('ai-confidence').innerText=`${p.c}%`;$('ai-reason').innerText=p.m},600)}
function _Z(){const h=_d.l,l=h[h.length-1].t,p=h.length>=2?h[h.length-2].t:null;let x=0,y=0,m="M4";if(l===p&&l!=='T'){l==='B'?x+=30:y+=30;m="Drg"}if(h.length>=3&&l!==p&&l!=='T'){l==='B'?y+=35:x+=35;m="Png"}let a=0,b=0;h.slice(-10).forEach(v=>{v.t==='B'?a++:v.t==='P'?b++:0});if(a>b+2)y+=20;else if(b>a+2)x+=20;else Math.random()>.5?x+=10:y+=10;const r=x>y?'B':'P';let c=Math.floor(Math.random()*31)+65;if(l==='T'){c-=15;m="Rsk"}return{r,c,m}}
function _Uw(){const e=$('wr-t'),b=$('wr-b');if(e&&b){let p=100;if(_st.t>0)p=Math.round((_st.c/_st.t)*100);e.innerText=`${p}%`;b.style.width=`${p}%`}}
function _Dr(){const c=$('cc');if(!c)return;const x=c.getContext('2d'),w=c.width,h=c.height;x.clearRect(0,0,w,h);x.strokeStyle='#334155';for(let i=0;i<=10;i++){x.beginPath();x.moveTo(w/10*i,0);x.lineTo(w/10*i,h);x.stroke();x.beginPath();x.moveTo(0,h/10*i);x.lineTo(w,h/10*i);x.stroke()}_d.l.forEach(l=>{const cx=l.c*(w/10)+(w/20),cy=l.r*(h/10)+(h/20);x.fillStyle=l.t==='P'?'#2563eb':l.t==='B'?'#dc2626':'#16a34a';x.beginPath();x.arc(cx,cy,15,0,Math.PI*2);x.fill();x.fillStyle='white';x.font='bold 12px sans-serif';x.textAlign='center';x.textBaseline='middle';x.fillText(l.t,cx,cy)})}
_0xAC(_0xAu,u=>{if(u){_u=u;_0xOS(_0xD(_0xDb,_k.u,u.uid),s=>{if(s.exists()){_tk=s.data().tokens||0;if($('bd'))$('bd').innerText=`Tokens: ${_tk}`}});if(['login','register'].includes(_v))_I('home')}else{_u=null;_tk=0;if(_v==='calculator')_I('login')}});
function _I(v){_v=v;const a=$('app');if(v==='home'){a.innerHTML=`<div class="p-8 text-center"><h1 class="text-4xl font-black text-pink-500 mb-8">BCR AI</h1><div class="flex gap-4 justify-center"><button id="g-c" class="bg-blue-600 p-4 rounded-xl font-bold text-white shadow-lg shadow-blue-500/50">CALCULATOR</button><button id="g-p" class="bg-slate-700 p-4 rounded-xl font-bold text-white border border-slate-600">BUY TOKENS</button></div></div>`;$('g-c').onclick=()=>_I('calculator');$('g-p').onclick=()=>_I('pricing')}else if(v==='calculator'){a.innerHTML=`<div class="p-4"><div class="flex justify-between items-center mb-6"><h2 class="font-bold text-white">AI ROOM</h2><span id="bd" class="text-pink-400 font-bold bg-pink-400/10 px-3 py-1 rounded-full">Tokens: ${_tk}</span><button id="ex" class="text-sm text-gray-400">Exit</button></div><div class="grid lg:grid-cols-2 gap-4"><div class="bg-slate-800 p-6 rounded-2xl border border-white/5"><div class="text-center mb-6"><div id="ai-result" class="text-6xl font-black text-white mb-2">?</div><div id="ai-confidence" class="text-green-400 font-bold">0%</div><div id="ai-reason" class="text-xs text-gray-500 mt-2">${_T('wt')}</div></div><div class="flex gap-2 mb-4"><button id="bp" class="flex-1 bg-blue-600 p-4 rounded-xl font-black text-2xl text-white">P</button><button id="bb" class="flex-1 bg-red-600 p-4 rounded-xl font-black text-2xl text-white">B</button><button id="bt" class="flex-1 bg-green-500 p-4 rounded-xl font-black text-2xl text-white">T</button></div><button id="br" class="w-full py-3 text-gray-500 font-bold bg-slate-900 rounded-xl">RESET</button></div><div class="bg-slate-800 p-4 rounded-2xl border border-white/5"><div class="flex justify-between text-xs text-gray-400 mb-2"><span>WINRATE</span><span id="wr-t">100%</span></div><div class="h-2 bg-slate-700 rounded-full overflow-hidden mb-4"><div id="wr-b" class="h-full bg-green-500 w-full"></div></div><canvas id="cc" width="800" height="400" class="w-full h-full object-contain"></canvas></div></div></div>`;$('ex').onclick=()=>_I('home');$('bp').onclick=()=>_A('P');$('bb').onclick=()=>_A('B');$('bt').onclick=()=>_A('T');$('br').onclick=()=>{_d={l:[],c:Array(10).fill(0)};_st={c:0,t:0};_pr=null;$('ai-result').innerText='?';_Dr();_Uw()};setTimeout(()=>{_Dr();_Uw()},100)}else if(v==='pricing'){a.innerHTML=`<div class="p-6 text-center"><h2 class="text-3xl font-bold text-white mb-8">SHOP</h2><div class="grid md:grid-cols-3 gap-4 mb-8">${_C('Starter','190k',60)}${_C('Pro','480k',200)}${_C('Master','950k',500)}</div><button id="bk" class="text-gray-400">Back</button></div>`;$('bk').onclick=()=>_I('home');document.querySelectorAll('.b-buy').forEach(b=>b.onclick=()=>_u?_P(b.dataset.n,b.dataset.t,parseInt(b.dataset.p.replace('k','000'))):_I('login'))}else{const l=v==='login';a.innerHTML=`<div class="min-h-screen flex items-center justify-center p-4"><div class="bg-slate-800 p-8 rounded-2xl w-full max-w-sm border border-white/10"><h2 class="text-2xl font-bold text-white mb-6 text-center">${l?'LOGIN':'REGISTER'}</h2><input id="ie" type="email" placeholder="Email" class="w-full mb-4 p-3 rounded-xl bg-slate-900 text-white border border-slate-700 outline-none"><input id="ip" type="password" placeholder="Password" class="w-full mb-6 p-3 rounded-xl bg-slate-900 text-white border border-slate-700 outline-none"><button id="sb" class="w-full bg-pink-600 text-white font-bold py-3 rounded-xl shadow-lg shadow-pink-600/20 mb-4">${l?'ENTER':'CREATE'}</button><p id="tg" class="text-center text-gray-400 cursor-pointer text-sm">${l?'No account? Register':'Have account? Login'}</p></div></div>`;$('tg').onclick=()=>_I(l?'register':'login');$('sb').onclick=async()=>{_L('sb',1);try{if(l)await _0xS(_0xAu,$('ie').value,$('ip').value);else{const c=await _0xC(_0xAu,$('ie').value,$('ip').value);await _0xSD(_0xD(_0xDb,_k.u,c.user.uid),{email:c.user.email,tokens:5})}}catch(e){alert(e.message);_L('sb',0)}}}}
function _C(n,p,t){return `<div class="bg-slate-800 p-6 rounded-2xl border border-white/5 hover:border-pink-500/50 transition"><h3 class="text-white font-bold">${n}</h3><div class="text-3xl font-black text-pink-500 my-4">${p}</div><button class="b-buy w-full bg-slate-700 hover:bg-pink-600 text-white font-bold py-3 rounded-xl transition" data-n="${n}" data-p="${p}" data-t="${t}">BUY ${t}</button></div>`}
_I('home');
